---
id: "VUL-2024-002"
title: "反射型XSS漏洞"
status: "resolved"
level: "III"
discoveredAt: "2024-01-20"
category: "Web安全"
description: "用户输入未经过滤直接输出到页面，存在XSS攻击风险"
tags: ["XSS", "前端安全", "输入验证"]
---

# 反射型XSS漏洞详细分析

## 漏洞描述

在搜索功能中发现反射型XSS漏洞，攻击者可以通过构造恶意URL执行JavaScript代码。

## 漏洞位置

文件：`/search.php`
行号：第28行

## 漏洞代码

\`\`\`php
echo "搜索结果：" . $_GET['query'];
\`\`\`

## 攻击向量

攻击者可以构造如下URL：

\`\`\`
https://example.com/search.php?query=<script>alert('XSS')</script>
\`\`\`

## 影响评估

- **机密性**：中 - 可能窃取用户Cookie
- **完整性**：中 - 可能修改页面内容
- **可用性**：低 - 不影响系统可用性

## 修复方案

1. 对用户输入进行HTML实体编码
2. 使用CSP（内容安全策略）
3. 实施输入验证

### 修复代码

\`\`\`php
echo "搜索结果：" . htmlspecialchars($_GET['query'], ENT_QUOTES, 'UTF-8');
\`\`\`

## 修复状态

✅ **已修复** - 2024年1月22日

## 验证测试

- [x] 输入验证测试
- [x] HTML编码测试  
- [x] CSP策略测试
- [x] 回归测试

## 参考资料

- [OWASP XSS Prevention Cheat Sheet](https://owasp.org/www-community/xss-filter-evasion-cheatsheet)
- [CWE-79: Cross-site Scripting](https://cwe.mitre.org/data/definitions/79.html)
